<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8"/>
	<link type="text/css" rel="stylesheet" href="http://www.lhendricks.org/css/avenir-white.css"/>
	<meta name="author" content="Lutz Hendricks"/>
	<meta name="affiliation" content="http://www.unc.edu"/>
<a style="color: rgb(102, 102, 102);" href="http://www.lhendricks.org"><span
style="font-weight: bold;">Lutz Hendricks - UNC - Department of
Economics</span></a><link rel="stylesheet" href="http://yandex.st/highlightjs/7.3/styles/default.min.css">
<script src="http://yandex.st/highlightjs/7.3/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script type="text/javascript"  
src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</head>
<body>

<h1 id="matlabodditiesandpitfalls">Matlab Oddities and Pitfalls</h1>

<h3 id="matrixindexing">Matrix Indexing</h3>

<p>Matlab is perfectly fine with invalid matrix indices.</p>

<p>The following code should produce a syntax error:</p>

<pre><code>```matlab
x =
     1     2     3
     4     5     6

&gt;&gt; x(5)
ans =
     3
```
</code></pre>

<p>This is a very common source of bugs.</p>

<h3 id="loadandsave">Load and Save</h3>

<p>The <code>load</code> command is insane. It writes variables to the workspace that cannot be seen in the code. Always use load as a function as in <code>m = load(filename)</code>.</p>

<p>Even then <code>load</code> is insane. To retrieve the contents of <code>m</code> you need to know its name. Example:</p>

<pre><code>```matlab
x = 10;
save('test.mat', 'x');
m = load('test.mat');
disp(m.x);
10
```
</code></pre>

<p>It&#8217;s best to write a wrapper for <code>load</code> and <code>save</code> so that <code>load2('test.mat')</code> returns <code>10</code> instead of <code>m</code>.</p>

<h3 id="numericprecision">Numeric Precision</h3>

<p>Matlab &#8220;downgrades&#8221; numeric precision to the lowest common denominator in calculations.</p>

<pre><code class="matlab">x=ones([1,1], 'uint8'); y = 1.2345;
&gt;&gt; z=x/y;
&gt;&gt; disp(z)
    1
&gt;&gt; class(z)
ans =
uint8
</code></pre>

<p>One solution: convert everything to <code>double</code> as soon as you load it.</p>

<p>Always check that intermediate results are still <code>double</code> (using <code>validateattributes</code>).</p>

<hr />

</body>
</html>
